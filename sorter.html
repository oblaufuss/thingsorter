<!DOCTYPE html>
<head>
	<style type="text/CSS">
		body{
			background-color: grey;
		}
		#fldLeft    {
			height: 180px;
			text-align: center;
			min-width: 120px;
			border: 1px solid #000;
			cursor:pointer;
			padding:10px;

		}
		#fldRight   {
			height: 180px;
			text-align: center;
			padding:10px;
			min-width: 120px;
			border: 1px solid #000;
			cursor:pointer;

		}
	</style>
</head>
<script type="text/javascript">
	var data = ["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];
	
	var rounds = 0; // number of times we've iterated through all the data
	var startSort = [];
	var endSort = [];
	
	// iterates through data
	var tier = 0; // x value
	var index = 0; // y value

	// for specific matchups
	var matches = 0; // number of matchups
	var left;
	var right;
	var oddsNends = false;
	
	// initialize everything
	function startup(){
		startSort = [data];
		endSort = [[],[]];
		console.log("Startup complete.");
		setupMatch();
	}

	// display current match on screen
	function setupMatch(){
		left = startSort[tier][index];
		right = startSort[tier][index + 1];
		// if we have an odd number of elements, reuse one from the last match
		if (right == null && !isDone()) {
			right = startSort[tier][index - 1];
			oddsNends = true;
		}
		//update html
		document.getElementById('fldLeft').innerHTML = left;
		document.getElementById('fldRight').innerHTML = right;
		isDone();
	}

	// check if the sort has completed and wrap up if so
	function isDone(){
		if (startSort.length >= data.length){
			document.getElementById('fldLeft').innerHTML = "you";
			document.getElementById('fldRight').innerHTML = "done";
			document.getElementById('fldLeft').onclick = null;
			document.getElementById('fldRight').onclick = null;
			return true;
		}
		return false;
	}

	// return match result
	function fnc_Sort(choice){
		matches++;

		var winIndex = tier*2;
		// tier to move result to 
		var leftResult = (choice == 1? winIndex : winIndex + 1);
		var rightResult = (choice == -1? winIndex : winIndex + 1);

		endSort[leftResult].push(left);
		if (!oddsNends) { // only push if this wasn't an odd number rematch
			endSort[rightResult].push(right);
		} else {
			oddsNends = false;
		}

		index = index + 2; //move to next pair
		if (atEndOfLine()){
			nextRow();
		}
		setupMatch();
	}


	function atEndOfLine(){
		return startSort[tier].length == 1
			|| startSort[tier].length - index < 1;
	}

	function nextRow(){
		index = 0; // restart at first index of next tier
		tier ++;
		if (tier > startSort.length - 1){ // if we've run out of tiers to sort
			resetRows();
		} else if (startSort[tier].length == 1){ // if this tier does not need sorting
			endSort[tier*2].push(startSort[tier][0]); // transfer the sorted item
			nextRow();// try again
		}
	}

	function resetRows(){
		rounds ++;
		index = 0;
		tier = 0;
		startSort = endSort;
		endSort = [];
		var buckets = Math.pow(2,rounds + 1);
		for (var i = 0; i < buckets; i++){
			endSort.push(new Array());
		}
		console.log(startSort);
		console.log(buckets + " lines in new array");
	}
	
</script>
<body onLoad="startup()">

	<table>
		<tr>
			<td id="fldLeft" onClick="fnc_Sort(1);"> Left</td>
			<td id="fldRight" onClick="fnc_Sort(-1);"> Right</td>
		</tr>
	</table>

</body>
